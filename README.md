# AREUH Assembler & Linker

AREUH means _Assembleur Relogeable En Utilisation Heuristique_ (French)

## Presentation

These programs constitute a complete development
system for the Saturn processor (used on the HP-71, HP-28,
HP-48 among others).  It includes an **assembler**, a **linker** for
separate assembly, and various utilities to generate message
tables for the HP-71 as well as download programs to the
HP-71 via HP-IL or RS-232.


## History

AREUH was developped for the HP-71 in order for us to produce
more easily the **JPC Rom** (PPC Paris Rom) for the HP-71.  The
final Rom module was 45 KB (executable) for a total of 1.5
MB source files.

Speed was one of the main design objectives.

These programs were written in C for the HP Integral PC
(under HP-UX) in 1986 and have been adaptated for PC
compatibles (Microsoft C 4.0 in 1987).

It was also used as the final stage of a simple C compiler
for the HP-71.

Source code for the programs has been updated in 2022 to use
modern C syntax and compile with modern C compilers (`clang` & `gcc`). 


## HP-71 dependencies

This development system is fully compatible with the
assembler described in the _HP-71 Internal Design
Specifications_ (Volumes I or IV).  The opcode syntax is the
one used by HP :  it seems crazy to invent a new one, just
to confuse everyone!

Some macros (`LEX`, `BIN`, `FORTH`, `TOKEN`...) are specific to the
HP-71, but you are free not to use them.

You may also want to write specific HP-48 macros to generate
specific objects (it would be nice if HP give us the syntax
they use).

Some opcodes used in newer machines (28, 48...)  are not
present in the HP-71.  Those opcodes (but `PC=(A)` and `RSI`)
are not in our opcode table, but could be easily added if
needed.

The linker preloads a special file (`/usr/local/lib/hp71.ep`)
containing all HP-71 operating system entry points.  If your
target is not the HP-71, do not
use any name contained in this file, or remove the loading
of this file.

In summary, HP-71 dependencies should not be a problem.
However if you want to use new opcodes, you will have to add
them.  Please, share your modifications.


## Contents

The contents of this directory are:

- `Makefile` :
	the global `Makefile` to generate all programs.

- `assembler` :
	source code for `aas` (the assembler).  Some files are
	shared between assembler, linker and dump (`common.h`,
	`err.h`), some are shared between assembler and linker
	(`exp.c`, `mdep.c`).
	Contains a manual page in French.

- `linker` :
	source code for `ald` (the linker).
	Contains a manual page in French.

- `dump` :
	source code for `adp` (the file dumper, used for
	debugging).
	Contains a manual page in French.

- `cpy` :
	source code for downloading files from a PC to an
	HP-71 using HP-IL Link card or RS-232.  This should
	now superseded for HP-48 by Kermit.

- `load` :
	source code for `acp`, utility for copying an
	executable file generated by the linker to a LIF
	disk (to be read by an HP-71 with HP-9114).

- `equ` :
	source for all HP-71 operating system entry points.

- `jmpdoc` :
	some thoughts about adding a new generic branch macro.
	In French. Garbage.

- `msg` :
	source code for `amg` (HP-71 message table generator).
	Contains a manual page in French.

- `doc` :
	various documentations.


## Porting to other platforms

AREUH works flawlessly on Linux, BSD operating systems and MacOS.
Compilation on Windows has not been attempted for lack of machine 
running this system.


## Authors and license

Pierre DAVID & Janick TAILLANDIER

This work is licensed under the [Cecill-B license](https://cecill.info/licences/Licence_CeCILL-B_V1-en.html).
In a nutshell, this license is similar to the BSD license:
you are free to use, modify or distribute these programs.
Please, keep this notice.

These programs are provided as is.  They are in no way
supported by us.

Have fun!


Pierre DAVID & Janick TAILLANDIER (July 1st, 1990 - October 8th, 2022)
